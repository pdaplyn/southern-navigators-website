---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const events = await getCollection('events');
  return events.map((event) => ({ params: { slug: event.slug }, props: { event } }));
}

const { event } = Astro.props;
const { Content } = await event.render();
---
<Layout title={event.data.title} description={event.data.summary ?? event.data.title}>
  <article>
    <h1 class="page-title">{event.data.title}</h1>
    <p>
      <time datetime={event.data.date.toISOString().slice(0, 10)}>
        {event.data.date.toLocaleDateString('en-GB', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}
      </time>
      {event.data.location ? ` · ${event.data.location}` : ''}
      {event.data.level ? <> · <span class="event-level">{event.data.level}</span></> : null}
    </p>
    {event.data.externalUrl && (
      <p><a href={event.data.externalUrl} target="_blank" rel="noopener">Event details / entries</a></p>
    )}
    {event.data.summary && <p class="summary">{event.data.summary}</p>}
    <Content />
  </article>
  <p><a href="/events/" class="btn btn-secondary">← Back to events</a></p>
</Layout>
